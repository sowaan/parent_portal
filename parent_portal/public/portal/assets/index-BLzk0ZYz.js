var m=(l,h,n)=>new Promise((x,c)=>{var g=r=>{try{u(n.next(r))}catch(i){c(i)}},C=r=>{try{u(n.throw(r))}catch(i){c(i)}},u=r=>r.done?x(r.value):Promise.resolve(r.value).then(g,C);u((n=n.apply(l,h)).next())});import{r as a,j as s,f as _}from"./index-DHC1J-Z3.js";import{X as B}from"./index.es-D46ozxa6.js";import{C as b,a as d}from"./CRow-CS0UGAKT.js";import{C as D}from"./CCard-Ctp6_UM5.js";import{C as H}from"./CCardHeader-CIQ_3opb.js";import{C as f}from"./CFormSelect-CilfhOwp.js";import{C as M}from"./CButton-DdvSfOFq.js";import{C as W}from"./CCardBody-DIRZnGaz.js";const L=()=>{const[l,h]=a.useState([]),[n,x]=a.useState([]),[c,g]=a.useState(""),[C,u]=a.useState([]),[r,i]=a.useState(""),[y,G]=a.useState([]),[S,R]=a.useState(""),[w,F]=a.useState([]);function E(){return m(this,null,function*(){try{let e=yield _.get("/api/method/parent_portal.parent_portal.api.get_student_details");u(e.data.message)}catch(e){console.error("Failed to fetch students:",e.response||e.message)}})}function A(){return m(this,null,function*(){try{let e=yield _.get("/api/method/parent_portal.parent_portal.api.get_assessment_groups");G(e.data.message)}catch(e){console.error("Failed to fetch groups:",e.response||e.message)}})}function j(){return m(this,null,function*(){try{let e=yield _.get("/api/method/parent_portal.parent_portal.api.get_student_results",{params:{student:r,group:S,course:c}});h(e.data.message);const t=e.data.message.filter(o=>o.details).flatMap(o=>o.details.map(p=>({student_name:o.student_name,course:o.course,schedule_date:o.schedule_date,assessment_group:o.assessment_group,assessment_criteria:p.assessment_criteria,maximum_score:p.maximum_score,score:p.score,grade:p.grade})));F(t)}catch(e){console.error("Failed to fetch results:",e.response||e.message)}})}function v(){return m(this,null,function*(){let e=[];for(let t=0;t<l.length;t++)e.includes(l[t].course)||e.push(l[t].course);x(e)})}a.useEffect(()=>{E(),A()},[]),a.useEffect(()=>{j(),v()},[]);const N=[{name:"Student Name",selector:e=>e.student_name,sortable:!0,maxWidth:"120px"},{name:"Course",selector:e=>e.course,sortable:!0,maxWidth:"120px"},{name:"Schedule Date",selector:e=>e.schedule_date,sortable:!0},{name:"Assessment Group",selector:e=>e.assessment_group,sortable:!0},{name:"Assessment Criteria",selector:e=>e.assessment_criteria,sortable:!0},{name:"Maximum Score",selector:e=>e.maximum_score,sortable:!0},{name:"Score",selector:e=>e.score,sortable:!0},{name:"Grade",selector:e=>e.grade,sortable:!0}];return s.jsx(b,{className:"mx-4",children:s.jsx(d,{xs:!0,children:s.jsxs(D,{className:"mb-4",children:[s.jsx(H,{children:s.jsxs(b,{children:[s.jsx(d,{xs:!0,children:s.jsxs(f,{"aria-label":"Select student",value:r,onChange:e=>{i(e.target.value),v()},children:[s.jsx("option",{value:"",children:"Student"}),C.map((e,t)=>s.jsx("option",{value:e.name,children:e.first_name},t))]})}),s.jsx(d,{xs:!0,children:s.jsxs(f,{"aria-label":"Select Group",value:S,onChange:e=>R(e.target.value),children:[s.jsx("option",{value:"",children:"Group"}),y.map((e,t)=>s.jsx("option",{value:e,children:e},t))]})}),s.jsx(d,{xs:!0,children:s.jsxs(f,{"aria-label":"Select course",value:c,onChange:e=>g(e.target.value),children:[s.jsx("option",{value:"",children:"Course"}),n.map((e,t)=>s.jsx("option",{value:e,children:e},t))]})}),s.jsx(d,{xs:!0,children:s.jsx(M,{color:"primary",style:{float:"right"},onClick:()=>j(),children:"Filter"})})]})}),s.jsx(W,{children:s.jsx(B,{columns:N,data:w,pagination:!0,striped:!0,highlightOnHover:!0})})]})})})};export{L as default};
