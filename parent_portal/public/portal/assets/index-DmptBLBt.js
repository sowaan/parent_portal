var d=(l,h,n)=>new Promise((x,c)=>{var g=a=>{try{u(n.next(a))}catch(i){c(i)}},_=a=>{try{u(n.throw(a))}catch(i){c(i)}},u=a=>a.done?x(a.value):Promise.resolve(a.value).then(g,_);u((n=n.apply(l,h)).next())});import{r,j as s,D as b,E as m,F as H,G as N,H as S,f as B,U as M,X as W,d as j}from"./index-CEegmSMn.js";const O=()=>{const[l,h]=r.useState([]),[n,x]=r.useState([]),[c,g]=r.useState(""),[_,u]=r.useState([]),[a,i]=r.useState(""),[y,G]=r.useState([]),[C,R]=r.useState(""),[w,F]=r.useState([]);function E(){return d(this,null,function*(){try{let e=yield j.get("/api/method/parent_portal.parent_portal.api.get_student_details");u(e.data.message)}catch(e){console.error("Failed to fetch students:",e.response||e.message)}})}function A(){return d(this,null,function*(){try{let e=yield j.get("/api/method/parent_portal.parent_portal.api.get_assessment_groups");G(e.data.message)}catch(e){console.error("Failed to fetch groups:",e.response||e.message)}})}function f(){return d(this,null,function*(){try{let e=yield j.get("/api/method/parent_portal.parent_portal.api.get_student_results",{params:{student:a,group:C,course:c}});h(e.data.message);const t=e.data.message.filter(o=>o.details).flatMap(o=>o.details.map(p=>({student_name:o.student_name,course:o.course,schedule_date:o.schedule_date,assessment_group:o.assessment_group,assessment_criteria:p.assessment_criteria,maximum_score:p.maximum_score,score:p.score,grade:p.grade})));F(t)}catch(e){console.error("Failed to fetch results:",e.response||e.message)}})}function v(){return d(this,null,function*(){let e=[];for(let t=0;t<l.length;t++)e.includes(l[t].course)||e.push(l[t].course);x(e)})}r.useEffect(()=>{E(),A()},[]),r.useEffect(()=>{f(),v()},[]);const D=[{name:"Student Name",selector:e=>e.student_name,sortable:!0,maxWidth:"120px"},{name:"Course",selector:e=>e.course,sortable:!0,maxWidth:"120px"},{name:"Schedule Date",selector:e=>e.schedule_date,sortable:!0},{name:"Assessment Group",selector:e=>e.assessment_group,sortable:!0},{name:"Assessment Criteria",selector:e=>e.assessment_criteria,sortable:!0},{name:"Maximum Score",selector:e=>e.maximum_score,sortable:!0},{name:"Score",selector:e=>e.score,sortable:!0},{name:"Grade",selector:e=>e.grade,sortable:!0}];return s.jsx(b,{className:"mx-4",children:s.jsx(m,{xs:!0,children:s.jsxs(H,{className:"mb-4",children:[s.jsx(N,{children:s.jsxs(b,{children:[s.jsx(m,{xs:!0,children:s.jsxs(S,{"aria-label":"Select student",value:a,onChange:e=>{i(e.target.value),v()},children:[s.jsx("option",{value:"",children:"Student"}),_.map((e,t)=>s.jsx("option",{value:e.name,children:e.first_name},t))]})}),s.jsx(m,{xs:!0,children:s.jsxs(S,{"aria-label":"Select Group",value:C,onChange:e=>R(e.target.value),children:[s.jsx("option",{value:"",children:"Group"}),y.map((e,t)=>s.jsx("option",{value:e,children:e},t))]})}),s.jsx(m,{xs:!0,children:s.jsxs(S,{"aria-label":"Select course",value:c,onChange:e=>g(e.target.value),children:[s.jsx("option",{value:"",children:"Course"}),n.map((e,t)=>s.jsx("option",{value:e,children:e},t))]})}),s.jsx(m,{xs:!0,children:s.jsx(B,{color:"primary",style:{float:"right"},onClick:()=>f(),children:"Filter"})})]})}),s.jsx(M,{children:s.jsx(W,{columns:D,data:w,pagination:!0,striped:!0,highlightOnHover:!0})})]})})})};export{O as default};
