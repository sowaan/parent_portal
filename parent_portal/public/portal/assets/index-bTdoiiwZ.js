var j=(c,p,o)=>new Promise((h,i)=>{var g=a=>{try{m(o.next(a))}catch(u){i(u)}},d=a=>{try{m(o.throw(a))}catch(u){i(u)}},m=a=>a.done?h(a.value):Promise.resolve(a.value).then(g,d);m((o=o.apply(c,p)).next())});import{r as l,F as S,j as s,f as G}from"./index-BqFFroKm.js";import{X as O}from"./index.es-ClF1I37k.js";import{C as A,T as r}from"./CommonClasses-DWDFnoTg.js";import{S as f}from"./SelectField-C2KTAYRg.js";const T=()=>{const[c,p]=l.useState([]),[o,h]=l.useState([]),[i,g]=l.useState(""),{data:d,isLoading:m}=S("parent_portal.parent_portal.api.get_student_details"),{data:a,isLoading:u}=S("parent_portal.parent_portal.api.get_assessment_groups"),[_,k]=l.useState(""),[v,C]=l.useState(""),[y,F]=l.useState([]),[R,b]=l.useState(!1);function N(){return j(this,null,function*(){try{b(!0);let e=yield G.get("/api/method/parent_portal.parent_portal.api.get_student_results",{params:{student:_,group:v,course:i}});p(e.data.message);const t=e.data.message.filter(n=>n.details).flatMap(n=>n.details.map(x=>({student_name:n.student_name,course:n.course,schedule_date:n.schedule_date,assessment_group:n.assessment_group,assessment_criteria:x.assessment_criteria,maximum_score:x.maximum_score,score:x.score,grade:x.grade})));F(t),b(!1)}catch(e){console.error("Failed to fetch results:",e.response||e.message)}})}function w(){return j(this,null,function*(){let e=[];for(let t=0;t<c.length;t++)e.includes(c[t].course)||e.push(c[t].course);h(e)})}l.useEffect(()=>{N(),w()},[]);const L=[{name:s.jsx("div",{className:r,children:"Student Name"}),selector:e=>s.jsx("div",{className:r,children:e.student_name}),sortable:!0,maxWidth:"120px"},{name:s.jsx("div",{className:r,children:"Course"}),selector:e=>s.jsx("p",{className:"text-black dark:text-white",children:e.course}),sortable:!0,maxWidth:"120px"},{name:s.jsx("div",{className:r,children:"Schedule Date"}),selector:e=>s.jsx("p",{className:"text-black dark:text-white",children:e.schedule_date}),sortable:!0},{name:s.jsx("div",{className:r,children:"Assessment Group"}),selector:e=>s.jsx("p",{className:"text-black dark:text-white",children:e.assessment_group}),sortable:!0},{name:s.jsx("div",{className:r,children:"Assessment Criteria"}),selector:e=>s.jsx("p",{className:"text-black dark:text-white",children:e.assessment_criteria}),sortable:!0},{name:s.jsx("div",{className:r,children:"Maximum Score"}),selector:e=>s.jsx("p",{className:"text-black dark:text-white",children:e.maximum_score}),sortable:!0},{name:s.jsx("div",{className:r,children:"Score"}),selector:e=>s.jsx("p",{className:"text-black dark:text-white",children:e.score}),sortable:!0},{name:s.jsx("div",{className:r,children:"Grade"}),selector:e=>s.jsx("p",{className:"text-black dark:text-white",children:e.grade}),sortable:!0}];return s.jsxs("div",{className:A,children:[s.jsxs("div",{className:"mb-5.5 flex flex-col gap-5.5 sm:flex-row justify-between items-center",children:[s.jsxs("div",{className:"flex flex-col gap-5.5 sm:flex-row",children:[s.jsx("div",{className:"w-full sm:w-47.5",children:s.jsx(f,{label:"",selectedOption:_,onChange:e=>{k(e.target.value),w()},options:s.jsxs(s.Fragment,{children:[s.jsx("option",{value:"",children:"Select Student"}),d&&d.message.map((e,t)=>s.jsx("option",{value:e.name,children:e.first_name},t))]})})}),s.jsx("div",{className:"w-full sm:w-47.5",children:s.jsx(f,{label:"",selectedOption:v,onChange:e=>C(e.target.value),options:s.jsxs(s.Fragment,{children:[s.jsx("option",{value:"",children:"Group"}),a&&a.message.map((e,t)=>s.jsx("option",{value:e,children:e},t))]})})}),s.jsx("div",{className:"w-full sm:w-47.5",children:s.jsx(f,{label:"",selectedOption:i,onChange:e=>g(e.target.value),options:s.jsxs(s.Fragment,{children:[s.jsx("option",{value:"",children:"Course"}),o.map((e,t)=>s.jsx("option",{value:e,children:e},t))]})})})]}),s.jsx("button",{onClick:()=>N(),className:"inline-flex float-end items-center justify-center gap-2.5 rounded-lg bg-primary py-3 px-10 text-center font-medium text-white hover:bg-opacity-90 lg:px-8 xl:px-10",children:"Filter"})]}),s.jsx("hr",{className:"mb-5.5"}),s.jsx(O,{columns:L,data:y,pagination:!0,pointerOnHover:!0,progressPending:R})]})};export{T as default};
