var D=Object.defineProperty,L=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var w=(t,a,s)=>a in t?D(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,y=(t,a)=>{for(var s in a||(a={}))H.call(a,s)&&w(t,s,a[s]);if(k)for(var s of k(a))I.call(a,s)&&w(t,s,a[s]);return t},F=(t,a)=>L(t,T(a));var f=(t,a,s)=>new Promise((h,u)=>{var j=m=>{try{d(s.next(m))}catch(x){u(x)}},b=m=>{try{d(s.throw(m))}catch(x){u(x)}},d=m=>m.done?h(m.value):Promise.resolve(m.value).then(j,b);d((s=s.apply(t,a)).next())});import{u as M,j as e,q as V,y as B,M as E,r as o,A as P,z as i,a as O,B as R,X as U,d as N}from"./index-CEegmSMn.js";const X=({parent:t,pageName:a})=>{const s=M();return e.jsxs("div",{className:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("button",{onClick:()=>s(-1),className:"font-semibold bg-gray dark:bg-gray-700 hover:bg-opacity-90 p-4 rounded-lg text-center",children:e.jsx("svg",{className:"fill-current",width:20,height:18,viewBox:"0 0 20 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M19 8.175H2.98748L9.36248 1.6875C9.69998 1.35 9.69998 0.825 9.36248 0.4875C9.02498 0.15 8.49998 0.15 8.16248 0.4875L0.399976 8.3625C0.0624756 8.7 0.0624756 9.225 0.399976 9.5625L8.16248 17.4375C8.31248 17.5875 8.53748 17.7 8.76248 17.7C8.98748 17.7 9.17498 17.625 9.36248 17.475C9.69998 17.1375 9.69998 16.6125 9.36248 16.275L3.02498 9.8625H19C19.45 9.8625 19.825 9.4875 19.825 9.0375C19.825 8.55 19.45 8.175 19 8.175Z",fill:!0})})}),e.jsx("nav",{children:e.jsxs("ol",{className:"flex items-center gap-2",children:[e.jsx("li",{children:e.jsxs(V,{className:"font-medium",to:`/${t}`,children:[t.toString().toUpperCase()," /"]})}),e.jsx("li",{className:"font-medium text-primary",children:a})]})})]})},$=[{name:"Fee Category",selector:t=>t.fees_category},{name:"Description",selector:t=>t.description},{name:"Amount",selector:t=>t.amount}],W=()=>{const{slug:t}=B(),{data:a}=E("Fees",t),[s,h]=o.useState(null),[u,j]=o.useState([]),[b,d]=o.useState(!1),[m,x]=o.useState(""),[_,g]=o.useState(""),[l,v]=o.useState({bank_name:"",transaction_number:"",holder_name:"",mobile_number:""}),p=n=>{const{name:r,value:c}=n.target;v(A=>F(y({},A),{[r]:c}))},C=n=>{h(n.target.files[0])},S=n=>f(void 0,null,function*(){n.preventDefault(),d(!0);try{if(!s)throw"Please select a file to upload.";if(l.bank_name==="")throw"Bank Name is required.";if(l.transaction_number==="")throw"Transaction Number is required.";if(l.holder_name==="")throw"Account Holder Name is required.";if(l.mobile_number==="")throw"Mobile Number is required.";yield N.post("/api/method/parent_portal.parent_portal.api.make_portal_payment_record",{fees:[a],bank_name:l.bank_name,tran_number:l.transaction_number,holder_name:l.holder_name,number:l.mobile_number}).then(r=>f(void 0,null,function*(){const c=new FormData;c.append("file",s),c.append("is_private",0),c.append("doctype","Portal Payment Record"),c.append("docname",r.data.message.record_name),yield N.post("/api/method/upload_file",c,{headers:{"Content-Type":"multipart/form-data",Accept:"application/json"}})})).catch(r=>g(r.response.data.message)),h(null),d(!1),v({bank_name:"",transaction_number:"",holder_name:"",mobile_number:""}),x("File uploaded successfully."),setTimeout(()=>{x(""),navigator("/student-fee")},2e3)}catch(r){g("Error during file upload:",r),d(!1)}});function q(){return f(this,null,function*(){try{const r=(yield N.get("/api/method/parent_portal.parent_portal.api.get_fees_attachment",{params:{fee_id:t}})).data.message;j(r)}catch(n){console.error("Failed to fetch attachments:",n.response||n.message)}})}return o.useEffect(()=>{q()},[s]),e.jsxs(e.Fragment,{children:[e.jsx(X,{parent:"student-fee",pageName:t}),e.jsx("div",{className:"col-span-5 xl:col-span-3",children:e.jsxs("div",{className:"rounded-xl border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark",children:[e.jsx("div",{className:"border-b border-stroke py-4 px-7 dark:border-strokedark",children:e.jsx("h3",{className:"font-medium text-black dark:text-white",children:"Fee Information"})}),e.jsxs("div",{className:"p-7",children:[m&&e.jsx("div",{className:"badge bg-success bg-opacity-10 text-success p-3 mb-2",children:m}),_&&e.jsx("div",{className:"badge bg-red-300 text-red p-3 mb-2",children:_}),e.jsxs("form",{onSubmit:S,children:[a&&a.parent_attachment?null:e.jsxs("div",{className:"mb-5.5 flex flex-col items-end justify-between gap-5.5 sm:flex-row",children:[e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-black dark:text-white",children:"Attach file"}),e.jsx("input",{type:"file",required:!0,onChange:C,disabled:a&&a.parent_attachment,className:`${P} w-full`})]}),e.jsx("button",{type:"submit",className:"flex cursor-pointer justify-center rounded bg-primary py-2 px-6 font-medium text-gray hover:bg-opacity-90",disabled:b||a&&a.parent_attachment,children:b?"Loading ...":"Submit"})]}),e.jsxs("div",{className:"mb-5.5 flex flex-col gap-5.5 sm:flex-row",children:[e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",htmlFor:"bank_name",children:"Bank Name"}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:i,type:"text",name:"bank_name",id:"bank_name",disabled:a&&a.parent_attachment,value:a?a.custom_bank_name:l.bank_name,onChange:p,required:!0})})]}),e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",htmlFor:"transaction_number",children:"Transaction Number"}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:i,type:"text",name:"transaction_number",id:"transaction_number",disabled:a&&a.parent_attachment,value:a?a.custom_transaction_number:l.transaction_number,onChange:p,required:!0})})]})]}),e.jsxs("div",{className:"mb-5.5 flex flex-col gap-5.5 sm:flex-row",children:[e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",htmlFor:"holder_name",children:"Account Holder Name"}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:i,type:"text",name:"holder_name",id:"holder_name",disabled:a&&a.parent_attachment,value:a?a.custom_account_holder_name:l.holder_name,onChange:p,required:!0})})]}),e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",htmlFor:"mobile_number",children:"Mobile Number"}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:i,type:"phone",name:"mobile_number",id:"mobile_number",disabled:a&&a.parent_attachment,value:a?a.custom_mobile_number:l.mobile_number,onChange:p,required:!0})})]})]}),e.jsx("hr",{className:"mb-4"}),e.jsxs("div",{className:"mb-5.5 flex flex-col gap-5.5 sm:flex-row",children:[e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",htmlFor:"studentName",children:"Student Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4.5 top-4",children:e.jsx(O,{className:"fill-current"})}),e.jsx("input",{className:R,type:"text",name:"studentName",id:"studentName",disabled:!0,defaultValue:a?a.student_name?a.student_name:a.student:""})]})]}),e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",htmlFor:"institution",children:"Institution"}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:i,type:"text",name:"institution",id:"institution",disabled:!0,defaultValue:a?a.company:""})})]})]}),e.jsxs("div",{className:"mb-5.5 flex flex-col gap-5.5 sm:flex-row",children:[e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",htmlFor:"date",children:"Date"}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:i,type:"text",name:"date",id:"date",disabled:!0,defaultValue:a?a.posting_date:""})})]}),e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",htmlFor:"due_date",children:"Due Date"}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:i,type:"text",name:"due_date",id:"due_date",disabled:!0,defaultValue:a?a.due_date:""})})]})]}),e.jsx("div",{className:"mb-2 col-12",children:a&&a.components.length>0?e.jsx(U,{columns:$,data:a.components,pagination:!0,highlightOnHover:!0,pointerOnHover:!0}):"No data found"}),e.jsxs("div",{className:"mb-5.5 flex flex-col gap-5.5 sm:flex-row",children:[e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",htmlFor:"total_tax",children:"Total Taxes and Charges"}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:i,type:"text",name:"total_tax",id:"total_tax",disabled:!0,defaultValue:a?a.total_taxes_and_charges:""})})]}),e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",htmlFor:"grand_total",children:"Grand Total"}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:i,type:"text",name:"grand_total",id:"grand_total",disabled:!0,defaultValue:a?a.grand_total:""})})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"mb-3 col-6",children:[e.jsx("label",{className:"mb-3 block text-sm font-medium text-black dark:text-white",children:"Attachments"}),u&&u.length>0?u.map((n,r)=>e.jsx("div",{children:e.jsx("a",{href:n.file_url,target:"_blank",rel:"noreferrer",children:n.name})},r)):e.jsx("div",{children:"No attachments found."})]})]})]})]})})]})};export{W as default};
